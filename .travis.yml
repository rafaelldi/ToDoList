services:
  - docker
    
branches:
  only:
    - master

script:
  - docker build -t todolist .
    
deploy:
  - provider: script
    script:
      docker login --username=_ --password=$HEROKU_TOKEN registry.heroku.com
      docker tag todolist registry.heroku.com/$HEROKU_APP_NAME/web
      docker push registry.heroku.com/$HEROKU_APP_NAME/web
    on:
      branch: master
      
after_deploy:
  - bash release